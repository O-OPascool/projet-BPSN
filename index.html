--- START OF FILE index.html ---
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion de Stock de Livres</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Recherche et Gestion de Stock</h1>
        <!-- Formulaire pour rechercher un livre via ISBN -->
        <form id="isbn-form" class="form">
   	 <input type="text" id="isbn" placeholder="Entrez un ISBN (10 ou 13 chiffres)" required
           oninvalid="this.setCustomValidity('Veuillez entrer un ISBN valide (10 ou 13 chiffres).')"
           oninput="this.setCustomValidity('')">
    	<button type="submit">Rechercher</button>
	</form>


        <div id="book-info" class="hidden">
            <img id="cover" src="" alt="Image de couverture">
            <p><strong>Titre :</strong> <span id="title"></span></p>
            <p><strong>Auteur :</strong> <span id="author"></span></p>
            <p><strong>Résumé :</strong> <span id="summary"></span></p>
            <p><strong>Disponibilité :</strong> <span id="stock" class="stock-info">Vérification en cours...</span></p>

            <!-- Formulaire pour mettre à jour le stock -->
            <form id="stock-form" class="stock-form">
                <label for="new-stock">Mettre à jour le stock :</label>
                <input type="number" id="new-stock" placeholder="Nombre d'exemplaires" required>
                <button type="submit">Mettre à jour</button>
            </form>
        </div>

        <!-- Liste des livres -->
        <h2>Liste des Livres Disponibles</h2>
        <input type="text" id="search-book" placeholder="Rechercher par titre ou auteur...">
        <div id="book-list"></div>

        <!-- Modal de confirmation -->
        <div id="confirmation-modal" class="modal hidden">
            <div class="modal-content">
                <p id="confirmation-message"></p>
                <div class="modal-buttons">
                    <button id="confirm-yes" class="confirm-button">Oui</button>
                    <button id="confirm-no" class="cancel-button">Non</button>
                </div>
            </div>
        </div>
        <div class="footer">
            <img src="./image.png" alt="Logo" class="footer-logo">
            <span>Design by pascool</span><br>
            <span>Test</span>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>
--- START OF FILE script.js ---
// Import des modules Firebase
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js";
import { getDatabase, ref, child, set, get, onValue } from "https://www.gstatic.com/firebasejs/9.6.7/firebase-database.js";

// Configuration Firebase
const firebaseConfig = {
    apiKey: "AIzaSyDKEewyRf8TgMjXCsfHfzvnCpBUG-GYDig",
    authDomain: "bpsn-74f1b.firebaseapp.com",
    databaseURL: "https://bpsn-74f1b-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "bpsn-74f1b",
    storageBucket: "bpsn-74f1b.firebasestorage.app",
    messagingSenderId: "1057707303676",
    appId: "1:1057707303676:web:63dd292678dead41c2ed79",
    measurementId: "G-DZGXBJERKQ"
};

// Initialisation Firebase
const app = initializeApp(firebaseConfig);
const database = getDatabase(app);

// Références Firebase
const stocksRef = ref(database, 'stocks');
const booksDataRef = ref(database, 'booksData');

// Fonction pour valider l'ISBN
function isValidISBN(isbn) {
    return (isbn.length === 10 || isbn.length === 13) && !isNaN(isbn);
}

// Gestion du formulaire de recherche
document.getElementById('isbn-form').addEventListener('submit', async function (event) {
    event.preventDefault();
    const isbn = document.getElementById('isbn').value.trim();

    if (!isValidISBN(isbn)) {
        alert("Veuillez entrer un ISBN valide (10 ou 13 chiffres).");
        return;
    }

    document.getElementById('book-info').classList.add('hidden');
    await fetchBookData(isbn);
});

// Récupérer ou ajouter les données d'un livre
async function fetchBookData(isbn) {
    try {
        const snapshot = await get(child(booksDataRef, isbn));
        if (snapshot.exists()) {
            const book = snapshot.val();
            displayBookData(isbn, book);
            displayStock(isbn);
        } else {
            const apiUrl = `https://www.googleapis.com/books/v1/volumes?q=isbn:${isbn}`;
            const response = await fetch(apiUrl);

            if (!response.ok) throw new Error(`Erreur API : ${response.status}`);

            const data = await response.json();
            if (data.totalItems > 0) {
                const book = data.items[0].volumeInfo;
                const bookData = {
                    title: book.title || 'Titre non disponible',
                    author: book.authors ? book.authors.join(', ') : 'Auteur inconnu',
                    summary: book.description || 'Aucun résumé disponible.',
                    cover: book.imageLinks?.thumbnail || './image.png'
                };

                await set(child(booksDataRef, isbn), bookData);
                displayBookData(isbn, bookData);
                displayStock(isbn);
            } else {
                alert('Aucun livre trouvé avec cet ISBN.');
            }
        }
    } catch (error) {
        console.error("Erreur lors de la récupération des données :", error);
        alert(`Erreur : ${error.message}`);
    }
}

// Afficher les données d'un livre
function displayBookData(isbn, bookData) {
    document.getElementById('title').innerText = bookData.title;
    document.getElementById('author').innerText = bookData.author;
    document.getElementById('summary').innerText = bookData.summary;
    document.getElementById('cover').src = bookData.cover;
    document.getElementById('book-info').classList.remove('hidden');
}

// Afficher le stock d'un livre
async function displayStock(isbn) {
    const stockElement = document.getElementById('stock');
    try {
        const snapshot = await get(child(stocksRef, isbn));
        const stockValue = snapshot.val();

        if (stockValue !== null) {
            stockElement.innerText = stockValue > 0
                ? `En stock : ${stockValue} exemplaires`
                : 'Hors stock';
        } else {
            stockElement.innerText = 'Stock non défini.';
        }
    } catch (error) {
        console.error("Erreur lors de la récupération du stock :", error);
    }
}

// Fonction pour gérer la mise à jour du stock
document.getElementById('stock-form').addEventListener('submit', async function (event) {
    event.preventDefault();
    const newStock = parseInt(document.getElementById('new-stock').value);
    const isbn = document.getElementById('isbn').value.trim();

    if (!isValidISBN(isbn)) {
        alert("ISBN non valide.");
        return;
    }

    if (!isNaN(newStock) && newStock >= 0) {
        try {
            await set(child(stocksRef, isbn), newStock);
            alert('Stock mis à jour avec succès !');
            displayStock(isbn);
        } catch (error) {
            console.error("Erreur lors de la mise à jour du stock :", error);
            alert('Impossible de mettre à jour le stock.');
        }
    } else {
        alert('Veuillez entrer une quantité valide.');
    }
});

// Initialiser la liste des livres avec écoute en temps réel
function initializeBookListListener() {
    const bookListElement = document.getElementById('book-list');

    onValue(booksDataRef, (booksDataSnapshot) => {
        onValue(stocksRef, (stocksSnapshot) => {
            const booksData = booksDataSnapshot.val() || {};
            const stocks = stocksSnapshot.val() || {};

            bookListElement.innerHTML = ''; // Réinitialiser la liste

            for (const isbn in booksData) {
                const bookData = booksData[isbn];
                const stock = stocks[isbn] || 0;

                const bookItem = document.createElement('div');
                bookItem.classList.add('book-item');

                bookItem.innerHTML = `
                    <div class="book-title"><strong>${bookData.title}</strong></div>
                    <div>Auteur : ${bookData.author}</div>
                    <div>Résumé : ${bookData.summary}</div>
                    <div>ISBN : <strong>${isbn}</strong></div>
                    <div class="stock-info ${stock > 0 ? 'in-stock' : 'out-of-stock'}">
                        ${stock > 0 ? `En stock : ${stock} exemplaire(s)` : 'Hors stock'}
                    </div>
                    <button class="delete-button" data-isbn="${isbn}">Supprimer</button>
                `;

                const deleteButton = bookItem.querySelector('.delete-button');
                deleteButton.addEventListener('click', function () {
                    deleteBook(isbn);
                });

                bookListElement.appendChild(bookItem);
            }
        });
    });
}

// Fonction pour supprimer un livre
function deleteBook(isbn) {
    if (confirm(`Êtes-vous sûr de vouloir supprimer le livre avec l'ISBN ${isbn} ?`)) {
        Promise.all([
            set(child(stocksRef, isbn), null), // Supprime le stock
            set(child(booksDataRef, isbn), null) // Supprime les données du livre
        ])
            .then(() => {
                alert('Livre supprimé avec succès.');
            })
            .catch(error => {
                console.error('Erreur lors de la suppression :', error);
            });
    }
}

// Filtrer les livres par titre ou auteur
function filterBookList() {
    const searchText = document.getElementById('search-book').value.toLowerCase();
    const bookItems = document.querySelectorAll('#book-list .book-item');

    bookItems.forEach(item => {
        const title = item.querySelector('.book-title').textContent.toLowerCase();
        const author = item.querySelector('div:nth-child(2)').textContent.toLowerCase();
        if (title.includes(searchText) || author.includes(searchText)) {
            item.style.display = 'block';
        } else {
            item.style.display = 'none';
        }
    });
}

// Initialiser la liste des livres au chargement
initializeBookListListener();

// Ajouter un écouteur pour la barre de recherche
document.getElementById('search-book').addEventListener('input', filterBookList);
--- START OF FILE styles.css ---
/* Styles de base pour le corps de la page */
body {
    font-family: 'Arial', sans-serif; /* Police de caractères */
    color: #333; /* Couleur du texte */
    margin: 0; /* Marge extérieure nulle */
    padding: 0; /* Marge intérieure nulle */

    /* Image de fond pour la page */
    background-image: url("background.jpg"); /* Remplacez par le chemin de votre image */
    background-size: cover; /* L'image couvre tout l'arrière-plan */
    background-repeat: no-repeat; /* L'image ne se répète pas */
    background-position: center; /* L'image est centrée */
    background-attachment: fixed; /* L'image reste fixe même si on scroll */
}

/* Styles pour le conteneur principal */
.container {
    width: 90%; /* Largeur de 90% */
    max-width: 800px; /* Largeur maximale de 800 pixels */
    margin: 20px auto; /* Marge extérieure automatique en haut/bas et de 20 pixels à gauche/droite */
    background: #fff; /* Fond blanc */
    padding: 20px; /* Marge intérieure de 20 pixels */
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* Ombre légère */
    border-radius: 8px; /* Coins arrondis */
    background-color: rgba(255, 255, 255, 0.8); /* Fond blanc avec 80% d'opacité */
}

/* Styles pour le titre principal */
h1 {
    text-align: center; /* Texte centré */
    color: #4CAF50; /* Couleur verte */
}

/* Styles pour les formulaires */
.form, .stock-form {
    display: flex; /* Utilisation du modèle de boîte flexible */
    flex-direction: column; /* Alignement vertical des éléments */
    align-items: center; /* Alignement horizontal centré */
}

/* Styles pour les champs de saisie de texte et de nombre */
input[type="text"], input[type="number"] {
    width: 80%; /* Largeur de 80% */
    padding: 10px; /* Marge intérieure de 10 pixels */
    margin: 10px 0; /* Marge extérieure de 10 pixels en haut/bas et de 0 à gauche/droite */
    border: 1px solid #ccc; /* Bordure grise de 1 pixel */
    border-radius: 4px; /* Coins arrondis */
}

/* Styles pour les boutons */
button {
    padding: 10px 15px; /* Marge intérieure de 10 pixels en haut/bas et de 15 pixels à gauche/droite */
    border: none; /* Pas de bordure */
    border-radius: 4px; /* Coins arrondis */
    background-color: #4CAF50; /* Couleur de fond verte */
    color: white; /* Texte en blanc */
    cursor: pointer; /* Curseur en forme de main au survol */
    transition: background-color 0.3s; /* Transition fluide de la couleur de fond */
    width: 100px;
}

/* Styles pour le survol des boutons */
button:hover {
    background-color: #45a049; /* Couleur de fond légèrement plus foncée au survol */
}

/* Styles pour la section d'informations sur le livre */
#book-info {
    margin-top: 20px; /* Marge supérieure de 20 pixels */
    text-align: center; /* Texte centré */
}

/* Styles pour l'image de couverture */
#cover {
    max-width: 100%; /* Largeur maximale de 100% */
    height: auto; /* Hauteur automatique pour conserver les proportions */
    border-radius: 4px; /* Coins arrondis */
}

/* Styles pour les informations de stock */
.stock-info {
    font-weight: bold; /* Texte en gras */
}

/* Styles pour les indicateurs de stock */
.in-stock {
    color: green; /* Couleur verte pour "en stock" */
}

.out-of-stock {
    color: red; /* Couleur rouge pour "hors stock" */
}

/* Styles pour la liste des livres */
#book-list {
    margin-top: 20px; /* Marge supérieure de 20 pixels */
    padding: 10px; /* Marge intérieure de 10 pixels */
    border: 1px solid #ccc; /* Bordure grise de 1 pixel */
    border-radius: 4px; /* Coins arrondis */
    background-color: #fafafa; /* Couleur de fond gris clair */
}

/* Styles pour les éléments de la liste des livres */
.book-item {
    border-bottom: 1px solid #ddd; /* Bordure inférieure grise de 1 pixel */
    padding: 10px 0; /* Marge intérieure de 10 pixels en haut/bas et de 0 à gauche/droite */
}

/* Styles pour le dernier élément de la liste des livres (pas de bordure inférieure) */
.book-item:last-child {
    border-bottom: none;
}

/* Styles pour le titre du livre */
.book-title {
    font-weight: bold; /* Texte en gras */
    color: #4CAF50; /* Couleur verte */
}

/* Styles pour la marge supérieure des informations de stock */
.stock-info {
    margin-top: 5px; /* Marge supérieure de 5 pixels */
}

/* Style pour le bouton Supprimer */
.delete-button {
    background-color: #d9534f; /* Couleur de fond rouge */
    color: white; /* Texte en blanc */
    border: none; /* Pas de bordure */
    padding: 5px 10px; /* Marge intérieure de 5 pixels en haut/bas et de 10 pixels à gauche/droite */
    border-radius: 4px; /* Coins arrondis */
    cursor: pointer; /* Curseur en forme de main au survol */
    margin-top: 5px; /* Marge supérieure de 5 pixels */
}

/* Styles pour le survol du bouton Supprimer */
.delete-button:hover {
    background-color: #c9302c; /* Couleur de fond légèrement plus foncée au survol */
}

/* Classe pour masquer les éléments */
.hidden {
    display: none;
}

/* Styles pour la barre de recherche */
#search-book {
    width: 50%; /* Largeur de 50% */
    padding: 10px; /* Marge intérieure de 10 pixels */
    margin: 10px 0; /* Marge extérieure de 10 pixels en haut/bas et de 0 à gauche/droite */
    border: 1px solid #ccc; /* Bordure grise de 1 pixel */
    border-radius: 4px; /* Coins arrondis */
}
